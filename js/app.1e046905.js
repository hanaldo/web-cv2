(function(e){function t(t){for(var a,c,r=t[0],s=t[1],l=t[2],d=0,p=[];d<r.length;d++)c=r[d],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&p.push(o[c][0]),o[c]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var s=n[r];0!==o[s]&&(a=!1)}a&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var a={},o={app:0},i=[];function c(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=a,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)c.d(n,a,function(t){return e[t]}.bind(null,a));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],s=r.push.bind(r);r.push=t,r=r.slice();for(var l=0;l<r.length;l++)t(r[l]);var u=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},2595:function(e,t,n){},4610:function(e,t,n){"use strict";n("4f17")},"4f17":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),o={id:"nav"},i=Object(a["g"])("Home"),c=Object(a["g"])(" | "),r=Object(a["g"])("About");function s(e,t){var n=Object(a["x"])("router-link"),s=Object(a["x"])("router-view");return Object(a["r"])(),Object(a["e"])(a["a"],null,[Object(a["f"])("div",o,[Object(a["h"])(n,{to:"/"},{default:Object(a["C"])((function(){return[i]})),_:1}),c,Object(a["h"])(n,{to:"/about"},{default:Object(a["C"])((function(){return[r]})),_:1})]),(Object(a["r"])(),Object(a["d"])(s,{key:e.$route.path}))],64)}n("e912");var l=n("6b0d"),u=n.n(l);const d={},p=u()(d,[["render",s]]);var f=p,v=n("6c02"),h=function(e){return Object(a["u"])("data-v-3a5cfee1"),e=e(),Object(a["s"])(),e},g={class:"menu"},m=h((function(){return Object(a["f"])("div",null,"Pick a translating Language:",-1)})),y={class:"list"},b=Object(a["g"])("JavasSript"),j=Object(a["g"])("Java");function k(e,t,n,o,i,c){var r=Object(a["x"])("router-link");return Object(a["r"])(),Object(a["e"])("div",null,[Object(a["f"])("div",g,[m,Object(a["f"])("div",y,[Object(a["h"])(r,{to:{name:"Flow",params:{lang:"javascript"}}},{default:Object(a["C"])((function(){return[b]})),_:1}),Object(a["h"])(r,{to:{name:"Flow",params:{lang:"java"}}},{default:Object(a["C"])((function(){return[j]})),_:1})])])])}var O={setup:function(){}};n("99d7");const x=u()(O,[["render",k],["__scopeId","data-v-3a5cfee1"]]);var w=x;function S(e,t,n,o,i,c){var r=Object(a["x"])("MySVG");return Object(a["r"])(),Object(a["e"])("div",null,[Object(a["h"])(r,{language:o.lang},null,8,["language"])])}n("b0c0");var C=function(e){return Object(a["u"])("data-v-160b85b8"),e=e(),Object(a["s"])(),e},E={class:"page my-border"},M=C((function(){return Object(a["f"])("div",{id:"drawing",class:"canvas"},null,-1)})),N={class:"code-area"};function I(e,t,n,o,i,c){var r=Object(a["x"])("highlightjs");return Object(a["r"])(),Object(a["e"])("div",E,[M,Object(a["f"])("div",N,[Object(a["f"])("div",null,Object(a["z"])(n.language.name),1),Object(a["h"])(r,{language:n.language.id,code:o.codes},null,8,["language","code"])])])}n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("498a"),n("a434"),n("159b"),n("ac1f");var P=n("4378"),L=(n("42fc"),n("ec26")),T=n("d4ec"),_=n("bee2"),V=n("262e"),G=n("2caf"),B=(n("cb29"),{exec:{name:"exec",color:"#d64c11",polygon:"0,0 20,0 30,10 20,20 0,20"},int:{name:"int",color:"#32cd32",polygon:"0,0 30,0 30,20 0,20"},string:{name:"string",color:"#d984bf",polygon:"0,0 30,0 30,20 0,20"}}),J=Object(_["a"])((function e(t,n,a,o,i,c,r){Object(T["a"])(this,e);var s=this,l=B[n].color;s.id=Object(L["a"])();var u=t.group(),d=u.polygon(B[n].polygon).attr({fill:l});if(u.move(o,i),"in"===a&&n===B.string.name){var p=u.foreignObject(50,23);p.add(Object(P["d"])('<input type="text" id="'+s.id+'" class="socket-input-string" />',!0)),p.move(30,i);var f=document.getElementById(s.id);f.addEventListener("input",(function(e){var t=e.target.value;s.value='"'+t+'"'})),s.value='""'}s.hideInput=function(){"in"===a&&n===B.string.name&&document.getElementById(s.id).remove()},u.on("mouseenter",(function(){c.canDrag=!1,d.fill("#0000ff"),u.css("cursor","pointer"),c.makingConnection&&c.endSocket!==s&&"in"===a&&(c.endSocket=s,c.endNode=r,console.log("endSocket"))})),u.on("mouseleave",(function(){c.canDrag=!0,d.fill(l),u.css("cursor",null),c.makingConnection&&(c.endSocket=null,c.endNode=null)})),u.on("mousedown",(function(){"out"===a&&(console.log("start to draw"),c.makingConnection=!0,c.startSocket=s,c.startNode=r)})),u.on("click",(function(){console.log(s.id+"\n"+s.value)})),s.flow=a,s.svg=u,s.type=n,s.node=r})),A=function(){function e(t,n,a,o,i){Object(T["a"])(this,e);var c=this,r=t.group();r.rect(200,200).attr({fill:"#fff","fill-opacity":.7,"stroke-width":2,stroke:"#000",rx:15}),r.draggable();var s=r.text(i);s.move(80,10),c.name=i,c.id=Object(L["a"])(),c.svg=r,c.text=s,c.connections=[],c.inputs=[],c.outputs=[],c.allPath=o,c.state=a,c.network=n,r.on("beforedrag",(function(e){a.canDrag||e.preventDefault()})),r.on("dragmove",(function(){r.front(),c.connections.forEach((function(e){var t=c.allPath.get(e.id),n=10;e.input.type===B.string.name&&(n=40),t.plot("M "+e.output.svg.cx()+" "+e.output.svg.cy()+" L "+(e.input.svg.cx()-n)+" "+e.input.svg.cy())}))}))}return Object(_["a"])(e,[{key:"next",value:function(e,t,n){var a=this.network.execConnections.get(e);a?a.node.execute(t,n):this.network.end()}},{key:"addSocket",value:function(e,t){var n=this,a=-10,o=20;"out"===t?(a=190,o+=40*n.outputs.length):o+=40*n.inputs.length;var i=new J(n.svg,e,t,a,o,n.state,n);"out"===t?n.outputs.push(i):n.inputs.push(i)}},{key:"addConnection",value:function(e,t,n){this.connections.push({id:e,output:t,input:n})}}]),e}(),D=function(e,t){return"java"===e?[{type:"static",value:"System"},{type:"static",value:"out"},{type:"call",value:"println",params:[{items:t}]}]:"javascript"===e?[{type:"static",value:"window"},{type:"call",value:"alert",params:[{items:t}]}]:[]},F=function(e){Object(V["a"])(n,e);var t=Object(G["a"])(n);function n(){return Object(T["a"])(this,n),t.apply(this,arguments)}return Object(_["a"])(n,[{key:"execute",value:function(e,t){var n=this,a=[];n.network.valueConnections.has(n.inputs[1].id)?(a.push({type:"localVar",id:"execution-instance",mid:"entrypoint"}),a.push({type:"classVar"}),n.trace(n.inputs[1].id,a[1])):a.push({type:"value",value:n.inputs[1].value});var o=D(t,a);e.children.push({type:"call",items:o}),n.next(n.outputs[0].id,e,t)}},{key:"trace",value:function(e,t){var n=this,a=n.network.valueConnections.get(e);t.id=a.node.id}}]),n}(A),U=function(e){Object(V["a"])(n,e);var t=Object(G["a"])(n);function n(){return Object(T["a"])(this,n),t.apply(this,arguments)}return Object(_["a"])(n,[{key:"execute",value:function(e,t){var n=this;if(n.network.valueConnections.has(n.inputs[1].id))console.log("ok I will find value");else{var a=n.inputs[1].value;e.children.push({type:"assign",left:{items:[{type:"localVar",id:"execution-instance",mid:"entrypoint"},{type:"classVar",id:n.id}]},right:{expression:{items:[{type:"value",value:a}]}}}),n.next(n.outputs[0].id,e,t)}}},{key:"buildTree",value:function(e,t){var n=this;e.children.push({type:"init",id:n.id,left:{class:"String",name:"myStringVar1"}}),t.children.push({type:"assign",left:{items:[{type:"instance"},{type:"classVar",id:n.id}]},right:{expression:{items:[{type:"value",value:'""'}]}}})}}]),n}(A),z=n("257e"),H=function(e){Object(V["a"])(n,e);var t=Object(G["a"])(n);function n(e,a,o,i,c){var r;Object(T["a"])(this,n),r=t.call(this,e,a,o,i,c);var s=Object(z["a"])(r),l=s.svg.foreignObject(200,100);l.add(Object(P["d"])('<button id="button1">Button</button>',!0)),l.move(0,100);var u=document.getElementById("button1");return u.addEventListener("click",(function(){a.refresh(),s.entrypointMethod?s.execute(s.entrypointMethod,s.lang):alert("You can no entrypoint!")})),r}return Object(_["a"])(n,[{key:"execute",value:function(e,t){this.next(this.outputs[0].id,e,t)}},{key:"setEntrypoint",value:function(e){this.entrypointMethod=e}},{key:"setLang",value:function(e){this.lang=e}}]),n}(A),Y=(n("fb6a"),{parseTreeNodeIds:function(e,t,n){var a=this;if("class"===e.type)console.log("class not need id");else if("init"===e.type){if("class"===n.type)t[0].set(e.id,e);else if("method"===n.type){var o=t[1].get(e.id);o||(o=new Map,t[1].set(e.id,o)),o.set(e.id,e)}}else if("method"===e.type){var i=t[1].get(e.id);i||(i=new Map,t[1].set(e.id,i)),e.params&&e.params.forEach((function(e){i.set(e.id,e)}))}e.children&&e.children.forEach((function(n){a.parseTreeNodeIds(n,t,e)}))},getIndent:function(e){if(e<1)return"";var t="";while(e>0)t+="\t",e-=1;return t},makeGetterPhrase:function(e,t,n){var a=this,o="";return e.forEach((function(i,c){if("instance"===i.type)o+=t;else if("classVar"===i.type){var r=n[0].get(i.id);o+=r.left.name}else if("localVar"===i.type){var s=n[1].get(i.mid).get(i.id);o+=s.left.name}else"value"===i.type?o+=i.value:"new"===i.type?o+="new "+i.value:"static"===i.type?o+=i.value:"call"===i.type?(o+=i.value,o+="(",i.params.forEach((function(e,t,i){o+=a.makeGetterPhrase(e.items,"this",n),t<i.length-1&&(o+=", ")})),o+=")"):"expression"===i.type&&console.log("call item may have parameters as expression");c<e.length-1&&(o+=".")})),o},makeExpression:function(e,t,n){var a=this;return e.operator?"("+a.makeExpression(e.left,t,n)+" "+e.operator+" "+a.makeExpression(e.right,t,n)+")":a.makeGetterPhrase(e.items,t,n)},getClassName:function(e){var t="";if(e.length>0){var n=0;while(n<e.length){var a=e[n].toLowerCase();t+=a.charAt(0).toUpperCase()+a.slice(1),n+=1}}return t},getReferenceName:function(e){var t=e[0].toLowerCase();if(e.length>0){var n=1;while(n<e.length){var a=e[n].toLowerCase();t+=a.charAt(0).toUpperCase()+a.slice(1),n+=1}}return t}});function q(e,t,n,a,o){var i=Y.getIndent(t),c="";"class"===e.type?c+=i+e.type+" "+e.name+" {\n":"method"===e.type?(c+=i+e.name+"(",e.params&&e.params.forEach((function(e,t){t>0&&(c+=", "),c+=e.name})),c+=") {\n"):"init"===e.type?"class"===o||(c+=i+e.left.class+" "+e.left.name,e.right&&(c+=" = "+Y.makeExpression(e.right.expression,"this",a)),c+=";\n"):"assign"===e.type?(c+=i+Y.makeGetterPhrase(e.left.items,"this",a),c+=" = "+Y.makeExpression(e.right.expression,"this",a)+";\n"):"entrypoint"===e.type||("call"===e.type?c+=Y.makeExpression(e,"this",a)+";\n":"if"===e.type&&(c+=i+"if "+Y.makeExpression(e.expression,"this",a)+" {\n")),"entrypoint"===o&&(c=c.trim()+"\n"),n[0]+=c,e.children?(e.children.forEach((function(o){q(o,t+1,n,a,e.id)})),"entrypoint"===e.type?n[0]+="\n":n[0]+=i+"}\n"):"class"!==e.type&&"method"!==e.type&&"if"!==e.type||(n[0]+=i+"}\n")}function R(e,t,n,a,o){var i=Y.getIndent(t),c="";"class"===e.type?c+=i+"public "+e.type+" "+e.name+" {\n":"method"===e.type?(c+=i+"public "+e.name+"(",e.params&&e.params.forEach((function(e,t){t>0&&(c+=", "),c+=e.class+" "+e.name})),c+=") {\n"):"init"===e.type?"class"===o?c+=i+"public "+e.left.class+" "+e.left.name+";\n":(c+=i+e.left.class+" "+e.left.name,e.right&&(c+=" = "+Y.makeExpression(e.right.expression,"this",a)),c+=";\n"):"assign"===e.type?(c+=i+Y.makeGetterPhrase(e.left.items,"this",a),c+=" = "+Y.makeExpression(e.right.expression,"this",a)+";\n"):"entrypoint"===e.type?c+=i+"public static void main(String[] args) {\n":"call"===e.type?c+=i+Y.makeExpression(e,"this",a)+";\n":"if"===e.type&&(c+=i+"if "+Y.makeExpression(e.expression,"this",a)+" {\n"),n[0]+=c,e.children?(e.children.forEach((function(o){R(o,t+1,n,a,e.id)})),n[0]+=i+"}\n"):"class"!==e.type&&"method"!==e.type&&"if"!==e.type||(n[0]+=i+"}\n")}var X={props:{language:Object},setup:function(e){console.log("MySVG comp");var t=Object(a["w"])(""),n=new Map,o={},i=[new Map,new Map],c={type:"class",id:"class",name:"Test",children:[]},r={type:"entrypoint",id:"entrypoint",children:[]},s="",l="";"javascript"===e.language.id?(s="const",l="constructor"):"java"===e.language.id&&(s="Test",l="Test"),o.execConnections=new Map,o.valueConnections=new Map,o.nodes=[],o.end=function(){var n=[""],a=[""];"javascript"===e.language.id?(q(c,0,n,i,null),q(r,0,a,i,"entrypoint"),t.value=n[0].trim()+"\n"+a[0].trim(),new Function(t.value)()):"java"===e.language.id&&(c.children.push(r),R(c,0,n,i,null),t.value=n[0].trim())},o.refresh=function(){i[0].clear(),i[1].clear(),c.children.splice(0,c.children.length),this.scanNodes(),r.children.splice(0,r.children.length),r.children.push({type:"init",id:"execution-instance",left:{class:s,name:"classInstance1"},right:{expression:{items:[{type:"new",value:"Test()"}]}}});var e=new Map;e.set("execution-instance",r.children[0]),i[1].set("entrypoint",e)},o.scanNodes=function(){var e={type:"method",id:Object(L["a"])(),name:l,return:{class:""},params:[],children:[]};o.nodes.forEach((function(t){t.buildTree&&t.buildTree(c,e)})),c.children.push(e),Y.parseTreeNodeIds(c,i,null),console.log(i[0].keys()),console.log(i[1].keys())};var u={makingConnection:!1,startSocket:null,endSocket:null,canDrag:!0,startNode:null,endNode:null};return Object(a["p"])((function(){console.log("svg onMounted");var t=Object(P["d"])().addTo("#drawing").size("70vw","100vh"),a=t.path("M 0 0 L 0 0");a.stroke({color:"#d61c00",width:5,linecap:"round",linejoin:"round"}),a.hide(),t.on("mouseup",(function(){if(u.makingConnection)if(u.endSocket)if(a.hide(),u.startNode===u.endNode)alert("Cannot make connection on the same node!");else if(o.execConnections.has(u.startSocket.id))alert("Output socket can only have 1 connection!");else if(o.execConnections.get(u.startSocket.id)===u.endSocket.id)alert("Cannot make duplicate connection!");else if(u.startSocket.type!==u.endSocket.type)alert("Not same type!");else{console.log("make connection!");var e=Object(L["a"])(),i=10;u.endSocket.type===B.string.name&&(i=40);var c=t.path("M "+u.startSocket.svg.cx()+" "+u.startSocket.svg.cy()+" L "+(u.endSocket.svg.cx()-i)+" "+u.endSocket.svg.cy());c.stroke({color:"#a63c01",width:5,linecap:"round",linejoin:"round"}),n.set(e,c),u.startNode.addConnection(e,u.startSocket,u.endSocket),u.endNode.addConnection(e,u.startSocket,u.endSocket),u.startNode.svg.front(),u.endNode.svg.front(),u.startSocket.type===B.exec.name?o.execConnections.set(u.startSocket.id,u.endSocket):o.valueConnections.set(u.endSocket.id,u.startSocket),u.endSocket.hideInput()}else a.hide();u.makingConnection=!1,u.startSocket=null,u.endSocket=null,u.startNode=null,u.endNode=null})),t.on("mousemove",(function(e){if(u.makingConnection){var t=u.startSocket.svg.cx(),n=u.startSocket.svg.cy(),o=e.offsetX,i=e.offsetY;a.plot("M "+t+" "+n+" L "+o+" "+i),a.show()}}));var i=new H(t,o,u,n,"Button v2");i.addSocket(B.exec.name,"out"),i.addSocket(B.int.name,"out"),i.setEntrypoint(r),i.setLang(e.language.id);var c=new U(t,o,u,n,"myStringVar1");c.addSocket(B.exec.name,"in"),c.addSocket(B.exec.name,"out"),c.addSocket(B.string.name,"out"),c.addSocket(B.string.name,"in");var s=new F(t,o,u,n,"Alert()");s.addSocket(B.exec.name,"in"),s.addSocket(B.exec.name,"out"),s.addSocket(B.string.name,"in"),o.nodes.push(i),o.nodes.push(c),o.nodes.push(s),o.refresh()})),Object(a["q"])((function(){console.log("svg onUnmounted");var e=document.getElementById("drawing");if(e){while(e.firstChild)e.removeChild(e.firstChild);console.log("removed all child")}})),{codes:t}}};n("4610");const $=u()(X,[["render",I],["__scopeId","data-v-160b85b8"]]);var K=$,Q={components:{MySVG:K},setup:function(){console.log("Flow comp");var e={javascript:{name:"JavaScript",id:"javascript"},java:{name:"Java",id:"java"}},t=Object(v["c"])();return{lang:e[t.params.lang]}}};const W=u()(Q,[["render",S]]);var Z=W,ee={class:"about"},te=Object(a["f"])("h1",null,"This is an about page",-1),ne=[te];function ae(e,t){return Object(a["r"])(),Object(a["e"])("div",ee,ne)}const oe={},ie=u()(oe,[["render",ae]]);var ce=ie,re=[{path:"/",name:"Home",component:w},{path:"/flow/:lang",name:"Flow",component:Z},{path:"/about",name:"About",component:ce}],se=Object(v["a"])({history:Object(v["b"])(),routes:re}),le=se,ue=n("5502"),de=Object(ue["a"])({state:{},mutations:{},actions:{},modules:{}}),pe=(n("6470"),n("1020")),fe=n.n(pe),ve=n("4dd1"),he=n.n(ve),ge=n("332f"),me=n.n(ge),ye=n("b056");fe.a.registerLanguage("javascript",he.a),fe.a.registerLanguage("java",me.a),Object(a["c"])(f).use(de).use(le).use(ye["a"]).mount("#app")},"96ce":function(e,t,n){},"99d7":function(e,t,n){"use strict";n("96ce")},e912:function(e,t,n){"use strict";n("2595")}});
//# sourceMappingURL=app.1e046905.js.map