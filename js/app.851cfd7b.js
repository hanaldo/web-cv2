(function(e){function t(t){for(var _,a,r=t[0],c=t[1],i=t[2],u=0,d=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(_ in c)Object.prototype.hasOwnProperty.call(c,_)&&(e[_]=c[_]);l&&l(t);while(d.length)d.shift()();return s.push.apply(s,i||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],_=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(_=!1)}_&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var _={},o={app:0},s=[];function a(e){return r.p+"js/"+({about:"about"}[e]||e)+"."+{about:"457b150a"}[e]+".js"}function r(t){if(_[t])return _[t].exports;var n=_[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var _=new Promise((function(t,_){n=o[e]=[t,_]}));t.push(n[2]=_);var s,c=document.createElement("script");c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.src=a(e);var i=new Error;s=function(t){c.onerror=c.onload=null,clearTimeout(u);var n=o[e];if(0!==n){if(n){var _=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;i.message="Loading chunk "+e+" failed.\n("+_+": "+s+")",i.name="ChunkLoadError",i.type=_,i.request=s,n[1](i)}o[e]=void 0}};var u=setTimeout((function(){s({type:"timeout",target:c})}),12e4);c.onerror=c.onload=s,document.head.appendChild(c)}return Promise.all(t)},r.m=e,r.c=_,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var _ in e)r.d(n,_,function(t){return e[t]}.bind(null,_));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=i;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0abd":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n("b0c0"),n("d3b7"),n("159b");var _=n("bdb1");function o(e,t,n,s,a){var r=_["a"].getIndent(t);if("class"===e.type)n[0]+=r+" "+e.type+" "+e.name+" {\n";else if("method"===e.type)n[0]+=r+" "+e.name+"(",e.params&&e.params.forEach((function(e,t){t>0&&(n[0]+=", "),n[0]+=e.class+" "+e.name})),n[0]+=") {\n";else if("init"===e.type)"class"!==a&&(n[0]+=r+" "+e.left.class+" "+e.left.name,n[0]+=" = "+_["a"].makeExpression(e.right.expression,"this",s,a)+";\n");else if("assign"===e.type)n[0]+=r+" "+_["a"].makeGetterPhrase(e.left.items,"this",s,a),n[0]+=" = "+_["a"].makeExpression(e.right.expression,"this",s,a)+";\n";else if("entrypoint"===e.type);else if("new"===e.type)n[0]+=r+" const "+e.name+" = new "+e.class+"();\n";else if("call"===e.type){var c="";e.items.forEach((function(e){"method"===e.type&&(c+=e.name,c+="(",e.params.forEach((function(e,t,n){e.items.forEach((function(e,t,n){"localVar"===e.type?c+=s[1].get(e.mid).get(e.id).name:"classVar"===e.type?c+=s[0].get(e.id).left.name:"value"===e.type&&(c+=e.value),t<n.length-1&&(c+=".")})),t<n.length-1&&(c+=", ")})),c+=");")})),n[0]+=r+c}else{if("if"!==e.type)return;n[0]+=r+"if "+_["a"].makeExpression(e.expression,"this",s,a)+" {\n"}e.children?(e.children.forEach((function(_){o(_,t+1,n,s,e.id)})),"if"===e.type&&(n[0]+=r+"}\n"),"entrypoint"===e.type?n[0]+="\n":n[0]+=r+" }\n"):"class"!==e.type&&"method"!==e.type&&"if"!==e.type||(n[0]+=r+" }\n")}},"0bcd":function(e,t,n){"use strict";n("d446")},3489:function(e,t,n){"use strict";t["a"]={exec:{name:"exec",color:"#d64c11",polygon:"0,0 20,0 30,10 20,20 0,20"},int:{name:"int",color:"#32cd32",polygon:"0,0 30,0 30,20 0,20"},string:{name:"string",color:"#d984bf",polygon:"0,0 30,0 30,20 0,20"}}},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var _=n("7a23"),o={id:"nav"},s=Object(_["f"])("Home"),a=Object(_["f"])(" | "),r=Object(_["f"])("About");function c(e,t){var n=Object(_["w"])("router-link"),c=Object(_["w"])("router-view");return Object(_["q"])(),Object(_["d"])(_["a"],null,[Object(_["e"])("div",o,[Object(_["g"])(n,{to:"/"},{default:Object(_["B"])((function(){return[s]})),_:1}),a,Object(_["g"])(n,{to:"/about"},{default:Object(_["B"])((function(){return[r]})),_:1})]),Object(_["g"])(c)],64)}n("0bcd");var i=n("6b0d"),u=n.n(i);const l={},d=u()(l,[["render",c]]);var p=d,f=(n("d3b7"),n("3ca3"),n("ddb0"),n("6c02"));function E(e,t,n,o,s,a){var r=Object(_["w"])("MySVG");return Object(_["q"])(),Object(_["d"])("div",null,[Object(_["g"])(r)])}var v=function(e){return Object(_["t"])("data-v-3610d08a"),e=e(),Object(_["r"])(),e},m={class:"page my-border"},b=v((function(){return Object(_["e"])("div",{id:"drawing",class:"canvas"},null,-1)})),O={class:"my-border code-area"};function k(e,t,n,o,s,a){return Object(_["q"])(),Object(_["d"])("div",m,[b,Object(_["e"])("div",O,[Object(_["e"])("span",null,Object(_["y"])(o.codes),1)])])}var h=n("7b5c");n("eb23");const g=u()(h["a"],[["render",k],["__scopeId","data-v-3610d08a"]]);var j=g,M={components:{MySVG:j}};const y=u()(M,[["render",E]]);var P=y,D=[{path:"/",name:"Home",component:P},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],w=Object(f["a"])({history:Object(f["b"])(),routes:D}),C=w,T=n("5502"),x=Object(T["a"])({state:{},mutations:{},actions:{},modules:{}});Object(_["c"])(p).use(x).use(C).mount("#app")},"7a81":function(e,t,n){},"7b5c":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_map_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4ec9"),core_js_modules_es_map_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_map_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("3ca3"),core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_string_iterator_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("a434"),core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_splice_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each_js__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("b0c0"),core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_function_name_js__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_7__),vue__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("7a23"),_svgdotjs_svg_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("4378"),_svgdotjs_svg_draggable_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("42fc"),uuid__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("ec26"),_models_MyNode_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("bf73"),_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("3489"),_logics_interpreter_js_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("0abd"),_logics_utils_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("bdb1");__webpack_exports__["a"]={setup:function setup(){var codes=Object(vue__WEBPACK_IMPORTED_MODULE_8__["v"])(""),allPath=new Map,network={},variableMaps=[new Map,new Map],codeTree={type:"class",id:"class",name:"Test",children:[]},entrypoint={type:"entrypoint",id:"entrypoint",children:[{type:"new",id:"execution-instance",class:"Test",name:"classInstance1"}]},entry=new Map;entry.set("execution-instance",entrypoint.children[0]),variableMaps[1].set("entrypoint",entry),network.execConnections=new Map,network.valueConnections=new Map,network.nodes=[],network.next=function(outSocketId){var nextInSocket=this.execConnections.get(outSocketId);if(nextInSocket)nextInSocket.node.execute(entrypoint);else{var codeText=[""];Object(_logics_interpreter_js_js__WEBPACK_IMPORTED_MODULE_14__["a"])(codeTree,1,codeText,variableMaps,null),console.log(codeText[0]);var entryText=[""];Object(_logics_interpreter_js_js__WEBPACK_IMPORTED_MODULE_14__["a"])(entrypoint,1,entryText,variableMaps,"entrypoint"),console.log(entryText[0]),codes.value=codeText[0]+entryText[0],eval(codes.value)}},network.trace=function(e,t){var n=this.valueConnections.get(e);"var"===n.node.comp&&(t.id=n.node.id)},network.fresh=function(){entrypoint.children.splice(0,entrypoint.children.length),entrypoint.children.push({type:"new",id:"execution-instance",class:"Test",name:"classInstance1"})},network.scanNodes=function(){var e={type:"method",id:Object(uuid__WEBPACK_IMPORTED_MODULE_11__["a"])(),name:"constructor",return:{class:""},params:[],children:[]};network.nodes.forEach((function(t){if("var"===t.comp){var n={expression:{items:[{type:"value",value:'""'}]}};codeTree.children.push({type:"init",id:t.id,left:{class:"String",name:"myStringVar1"},right:n}),e.children.push({type:"assign",left:{items:[{type:"instance"},{type:"classVar",id:t.id}]},right:n})}})),codeTree.children.push(e),_logics_utils_js__WEBPACK_IMPORTED_MODULE_15__["a"].parseTreeNodeIds(codeTree,variableMaps,null),console.log(variableMaps)};var state={makingConnection:!1,startSocket:null,endSocket:null,canDrag:!0,startNode:null,endNode:null};return Object(vue__WEBPACK_IMPORTED_MODULE_8__["o"])((function(){var e=Object(_svgdotjs_svg_js__WEBPACK_IMPORTED_MODULE_9__["d"])().addTo("#drawing").size("80vw","100vh"),t=e.path("M 0 0 L 0 0");t.stroke({color:"#d61c00",width:5,linecap:"round",linejoin:"round"}),t.hide(),e.on("mouseup",(function(){if(state.makingConnection)if(state.endSocket)if(t.hide(),state.startNode===state.endNode)alert("Cannot make connection on the same node!");else if(network.execConnections.has(state.startSocket.id))alert("Output socket can only have 1 connection!");else if(network.execConnections.get(state.startSocket.id)===state.endSocket.id)alert("Cannot make duplicate connection!");else if(state.startSocket.type!==state.endSocket.type)alert("Not same type!");else{console.log("make connection!");var n=Object(uuid__WEBPACK_IMPORTED_MODULE_11__["a"])(),_=10;state.endSocket.type===_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].string.name&&(_=40);var o=e.path("M "+state.startSocket.svg.cx()+" "+state.startSocket.svg.cy()+" L "+(state.endSocket.svg.cx()-_)+" "+state.endSocket.svg.cy());o.stroke({color:"#a63c01",width:5,linecap:"round",linejoin:"round"}),allPath.set(n,o),state.startNode.addConnection(n,state.startSocket,state.endSocket),state.endNode.addConnection(n,state.startSocket,state.endSocket),state.startNode.svg.front(),state.endNode.svg.front(),state.startSocket.type===_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].exec.name?network.execConnections.set(state.startSocket.id,state.endSocket):network.valueConnections.set(state.endSocket.id,state.startSocket),console.log(network)}else t.hide();state.makingConnection=!1,state.startSocket=null,state.endSocket=null,state.startNode=null,state.endNode=null})),e.on("mousemove",(function(e){if(state.makingConnection){var n=state.startSocket.svg.cx(),_=state.startSocket.svg.cy(),o=e.offsetX,s=e.offsetY;t.plot("M "+n+" "+_+" L "+o+" "+s),t.show()}}));var n=new _models_MyNode_js__WEBPACK_IMPORTED_MODULE_12__["a"](e,network,state,allPath,"Button v2","button");n.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].exec.name,"out"),n.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].int.name,"out");var _=new _models_MyNode_js__WEBPACK_IMPORTED_MODULE_12__["a"](e,network,state,allPath,"myStringVar1","var");_.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].exec.name,"in"),_.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].exec.name,"out"),_.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].string.name,"out"),_.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].string.name,"in");var o=new _models_MyNode_js__WEBPACK_IMPORTED_MODULE_12__["a"](e,network,state,allPath,"Alert()","alert()");o.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].exec.name,"in"),o.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].exec.name,"out"),o.addSocket(_values_sockets_js__WEBPACK_IMPORTED_MODULE_13__["a"].string.name,"in"),network.nodes.push(n),network.nodes.push(_),network.nodes.push(o),network.scanNodes()})),{codes:codes}}}},bdb1:function(e,t,n){"use strict";n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("b0c0"),n("fb6a");t["a"]={parseTreeNodeIds:function(e,t,n){var _=this;if("class"===e.type)console.log("class not need id");else if("init"===e.type){if("class"===n.type)t[0].set(e.id,e);else if("method"===n.type){var o=t[1].get(e.id);o||(o=new Map,t[1].set(e.id,o)),o.set(e.id,e)}}else if("method"===e.type){var s=t[1].get(e.id);s||(s=new Map,t[1].set(e.id,s)),e.params&&e.params.forEach((function(e){s.set(e.id,e)}))}e.children&&e.children.forEach((function(n){_.parseTreeNodeIds(n,t,e)}))},getIndent:function(e){if(e<1)return"";var t="";while(e>0)t+="\t",e-=1;return t},makeGetterPhrase:function(e,t,n,_){var o="";return e.forEach((function(s,a){if("instance"===s.type)o+=t;else if("classVar"===s.type){var r=n[0].get(s.id);o+=r.left.name}else if("localVar"===s.type){var c=n[1].get(_).get(s.id);o+=c.name}else"value"===s.type&&(o+=s.value);a+1!==e.length&&(o+=".")})),o},makeExpression:function(e,t,n,_){var o=this;return e.operator?"("+o.makeExpression(e.left,t,n,_)+" "+e.operator+" "+o.makeExpression(e.right,t,n,_)+")":o.makeGetterPhrase(e.items,t,n,_)},getClassName:function(e){var t="";if(e.length>0){var n=0;while(n<e.length){var _=e[n].toLowerCase();t+=_.charAt(0).toUpperCase()+_.slice(1),n+=1}}return t},getReferenceName:function(e){var t=e[0].toLowerCase();if(e.length>0){var n=1;while(n<e.length){var _=e[n].toLowerCase();t+=_.charAt(0).toUpperCase()+_.slice(1),n+=1}}return t}}},bf73:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var _=n("d4ec"),o=n("bee2"),s=(n("b0c0"),n("d3b7"),n("159b"),n("ec26")),a=(n("cb29"),n("4378")),r=n("3489"),c=Object(o["a"])((function e(t,n,o,c,i,u,l){Object(_["a"])(this,e);var d=this,p=r["a"][n].color;d.id=Object(s["a"])();var f=t.group(),E=f.polygon(r["a"][n].polygon).attr({fill:p});if(f.move(c,i),"in"===o&&n===r["a"].string.name){var v=f.foreignObject(50,23);v.add(Object(a["d"])('<input type="text" id="'+d.id+'" class="socket-input-string" />',!0)),v.move(30,i);var m=document.getElementById(d.id);m.addEventListener("input",(function(e){var t=e.target.value;d.value='"'+t+'"'})),d.value='""'}f.on("mouseenter",(function(){u.canDrag=!1,E.fill("#0000ff"),f.css("cursor","pointer"),u.makingConnection&&u.endSocket!==d&&"in"===o&&(u.endSocket=d,u.endNode=l,console.log("endSocket"))})),f.on("mouseleave",(function(){u.canDrag=!0,E.fill(p),f.css("cursor",null),u.makingConnection&&(u.endSocket=null,u.endNode=null)})),f.on("mousedown",(function(){"out"===o&&(console.log("start to draw"),u.makingConnection=!0,u.startSocket=d,u.startNode=l)})),f.on("click",(function(){alert(d.id+"\n\n"+d.value)})),d.flow=o,d.svg=f,d.type=n,d.node=l})),i=function(){function e(t,n,o,c,i,u){Object(_["a"])(this,e);var l=this,d=t.group();d.rect(200,200).attr({fill:"#fff","fill-opacity":.7,"stroke-width":2,stroke:"#000",rx:15}),d.draggable();var p=d.text(i);if(p.move(80,10),"button"===u){var f=d.foreignObject(200,100);f.add(Object(a["d"])('<button id="button1">Button</button>',!0)),f.move(0,100);var E=document.getElementById("button1");E.addEventListener("click",(function(){n.fresh(),l.execute(l.entrypointMethod)}))}l.name=i,l.id=Object(s["a"])(),l.svg=d,l.text=p,l.connections=[],l.inputs=[],l.outputs=[],l.allPath=c,l.state=o,l.network=n,l.comp=u,d.on("beforedrag",(function(e){o.canDrag||e.preventDefault()})),d.on("dragmove",(function(){d.front(),l.connections.forEach((function(e){var t=l.allPath.get(e.id),n=10;e.input.type===r["a"].string.name&&(n=40),t.plot("M "+e.output.svg.cx()+" "+e.output.svg.cy()+" L "+(e.input.svg.cx()-n)+" "+e.input.svg.cy())}))}))}return Object(o["a"])(e,[{key:"setEntrypoint",value:function(e){this.entrypointMethod=e}},{key:"execute",value:function(e){var t=this;if("button"===t.comp)t.network.next(t.outputs[0].id);else if("var"===t.comp)if(t.network.valueConnections.has(t.inputs[1].id))console.log("ok I will find value");else{var n=t.inputs[1].value;e.children.push({type:"assign",left:{items:[{type:"localVar",id:"execution-instance",mid:"entrypoint"},{type:"classVar",id:t.id}]},right:{expression:{items:[{type:"value",value:n}]}}}),t.network.next(t.outputs[0].id)}else if("alert()"===t.comp){var _=[];t.network.valueConnections.has(t.inputs[1].id)?(_.push({type:"localVar",id:"execution-instance",mid:"entrypoint"}),_.push({type:"classVar"}),t.network.trace(t.inputs[1].id,_[1])):_.push({type:"value",value:t.inputs[1].value}),e.children.push({type:"call",items:[{type:"method",name:"alert",params:[{items:_}]}]}),t.network.next(t.outputs[0].id)}}},{key:"addSocket",value:function(e,t){var n=this,_=-10,o=20;"out"===t?(_=190,o+=40*n.outputs.length):o+=40*n.inputs.length;var s=new c(n.svg,e,t,_,o,n.state,n);"out"===t?n.outputs.push(s):n.inputs.push(s)}},{key:"addConnection",value:function(e,t,n){this.connections.push({id:e,output:t,input:n})}}]),e}()},d446:function(e,t,n){},eb23:function(e,t,n){"use strict";n("7a81")}});
//# sourceMappingURL=app.851cfd7b.js.map