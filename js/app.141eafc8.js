(function(e){function t(t){for(var o,i,c=t[0],s=t[1],u=t[2],l=0,p=[];l<c.length;l++)i=c[l],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);d&&d(t);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(o=!1)}o&&(r.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},a={app:0},r=[];function i(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"b4a99f52"}[e]+".js"}function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=o);var r,s=document.createElement("script");s.charset="utf-8",s.timeout=120,c.nc&&s.setAttribute("nonce",c.nc),s.src=i(e);var u=new Error;r=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=a[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",u.name="ChunkLoadError",u.type=o,u.request=r,n[1](u)}a[e]=void 0}};var l=setTimeout((function(){r({type:"timeout",target:s})}),12e4);s.onerror=s.onload=r,document.head.appendChild(s)}return Promise.all(t)},c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=u;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0bcd":function(e,t,n){"use strict";n("d446")},"4ea1":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),a={id:"nav"},r=Object(o["f"])("Home"),i=Object(o["f"])(" | "),c=Object(o["f"])("About");function s(e,t){var n=Object(o["w"])("router-link"),s=Object(o["w"])("router-view");return Object(o["q"])(),Object(o["d"])(o["a"],null,[Object(o["e"])("div",a,[Object(o["g"])(n,{to:"/"},{default:Object(o["A"])((function(){return[r]})),_:1}),i,Object(o["g"])(n,{to:"/about"},{default:Object(o["A"])((function(){return[c]})),_:1})]),Object(o["g"])(s)],64)}n("0bcd");var u=n("6b0d"),l=n.n(u);const d={},p=l()(d,[["render",s]]);var f=p,v=(n("d3b7"),n("3ca3"),n("ddb0"),n("6c02"));function h(e,t,n,a,r,i){var c=Object(o["w"])("MySVG");return Object(o["q"])(),Object(o["d"])("div",null,[Object(o["g"])(c)])}var m=function(e){return Object(o["t"])("data-v-504bdd84"),e=e(),Object(o["r"])(),e},g={class:"page my-border"},y=m((function(){return Object(o["e"])("div",{id:"drawing",class:"canvas"},null,-1)})),b={class:"code-area"},k=m((function(){return Object(o["e"])("div",null,"JavaScript",-1)}));function j(e,t,n,a,r,i){var c=Object(o["w"])("highlightjs");return Object(o["q"])(),Object(o["d"])("div",g,[y,Object(o["e"])("div",b,[k,Object(o["g"])(c,{language:"javascript",code:a.codes},null,8,["code"])])])}n("4ec9"),n("498a"),n("a434"),n("159b"),n("b0c0"),n("ac1f");var w=n("4378"),O=(n("42fc"),n("ec26")),x=n("d4ec"),S=n("bee2"),C=(n("cb29"),{exec:{name:"exec",color:"#d64c11",polygon:"0,0 20,0 30,10 20,20 0,20"},int:{name:"int",color:"#32cd32",polygon:"0,0 30,0 30,20 0,20"},string:{name:"string",color:"#d984bf",polygon:"0,0 30,0 30,20 0,20"}}),E=Object(S["a"])((function e(t,n,o,a,r,i,c){Object(x["a"])(this,e);var s=this,u=C[n].color;s.id=Object(O["a"])();var l=t.group(),d=l.polygon(C[n].polygon).attr({fill:u});if(l.move(a,r),"in"===o&&n===C.string.name){var p=l.foreignObject(50,23);p.add(Object(w["d"])('<input type="text" id="'+s.id+'" class="socket-input-string" />',!0)),p.move(30,r);var f=document.getElementById(s.id);f.addEventListener("input",(function(e){var t=e.target.value;s.value='"'+t+'"'})),s.value='""'}s.hideInput=function(){"in"===o&&n===C.string.name&&document.getElementById(s.id).remove()},l.on("mouseenter",(function(){i.canDrag=!1,d.fill("#0000ff"),l.css("cursor","pointer"),i.makingConnection&&i.endSocket!==s&&"in"===o&&(i.endSocket=s,i.endNode=c,console.log("endSocket"))})),l.on("mouseleave",(function(){i.canDrag=!0,d.fill(u),l.css("cursor",null),i.makingConnection&&(i.endSocket=null,i.endNode=null)})),l.on("mousedown",(function(){"out"===o&&(console.log("start to draw"),i.makingConnection=!0,i.startSocket=s,i.startNode=c)})),l.on("click",(function(){console.log(s.id+"\n"+s.value)})),s.flow=o,s.svg=l,s.type=n,s.node=c})),N=function(){function e(t,n,o,a,r,i){Object(x["a"])(this,e);var c=this,s=t.group();s.rect(200,200).attr({fill:"#fff","fill-opacity":.7,"stroke-width":2,stroke:"#000",rx:15}),s.draggable();var u=s.text(r);if(u.move(80,10),"button"===i){var l=s.foreignObject(200,100);l.add(Object(w["d"])('<button id="button1">Button</button>',!0)),l.move(0,100);var d=document.getElementById("button1");d.addEventListener("click",(function(){n.fresh(),c.execute(c.entrypointMethod)}))}c.name=r,c.id=Object(O["a"])(),c.svg=s,c.text=u,c.connections=[],c.inputs=[],c.outputs=[],c.allPath=a,c.state=o,c.network=n,c.comp=i,s.on("beforedrag",(function(e){o.canDrag||e.preventDefault()})),s.on("dragmove",(function(){s.front(),c.connections.forEach((function(e){var t=c.allPath.get(e.id),n=10;e.input.type===C.string.name&&(n=40),t.plot("M "+e.output.svg.cx()+" "+e.output.svg.cy()+" L "+(e.input.svg.cx()-n)+" "+e.input.svg.cy())}))}))}return Object(S["a"])(e,[{key:"setEntrypoint",value:function(e){this.entrypointMethod=e}},{key:"execute",value:function(e){var t=this;if("button"===t.comp)t.network.next(t.outputs[0].id);else if("var"===t.comp)if(t.network.valueConnections.has(t.inputs[1].id))console.log("ok I will find value");else{var n=t.inputs[1].value;e.children.push({type:"assign",left:{items:[{type:"localVar",id:"execution-instance",mid:"entrypoint"},{type:"classVar",id:t.id}]},right:{expression:{items:[{type:"value",value:n}]}}}),t.network.next(t.outputs[0].id)}else if("alert()"===t.comp){var o=[];t.network.valueConnections.has(t.inputs[1].id)?(o.push({type:"localVar",id:"execution-instance",mid:"entrypoint"}),o.push({type:"classVar"}),t.network.trace(t.inputs[1].id,o[1])):o.push({type:"value",value:t.inputs[1].value}),e.children.push({type:"call",items:[{type:"static",value:"window"},{type:"call",value:"alert",params:[{items:o}]}]}),t.network.next(t.outputs[0].id)}}},{key:"addSocket",value:function(e,t){var n=this,o=-10,a=20;"out"===t?(o=190,a+=40*n.outputs.length):a+=40*n.inputs.length;var r=new E(n.svg,e,t,o,a,n.state,n);"out"===t?n.outputs.push(r):n.inputs.push(r)}},{key:"addConnection",value:function(e,t,n){this.connections.push({id:e,output:t,input:n})}}]),e}(),M=(n("fb6a"),{parseTreeNodeIds:function(e,t,n){var o=this;if("class"===e.type)console.log("class not need id");else if("init"===e.type){if("class"===n.type)t[0].set(e.id,e);else if("method"===n.type){var a=t[1].get(e.id);a||(a=new Map,t[1].set(e.id,a)),a.set(e.id,e)}}else if("method"===e.type){var r=t[1].get(e.id);r||(r=new Map,t[1].set(e.id,r)),e.params&&e.params.forEach((function(e){r.set(e.id,e)}))}e.children&&e.children.forEach((function(n){o.parseTreeNodeIds(n,t,e)}))},getIndent:function(e){if(e<1)return"";var t="";while(e>0)t+="\t",e-=1;return t},makeGetterPhrase:function(e,t,n){var o=this,a="";return e.forEach((function(r,i){if("instance"===r.type)a+=t;else if("classVar"===r.type){var c=n[0].get(r.id);a+=c.left.name}else if("localVar"===r.type){var s=n[1].get(r.mid).get(r.id);a+=s.left.name}else"value"===r.type?a+=r.value:"new"===r.type?a+="new "+r.value:"static"===r.type?a+=r.value:"call"===r.type?(a+=r.value,a+="(",r.params.forEach((function(e,t,r){a+=o.makeGetterPhrase(e.items,"this",n),t<r.length-1&&(a+=", ")})),a+=")"):"expression"===r.type&&console.log("call item may have parameters as expression");i<e.length-1&&(a+=".")})),a},makeExpression:function(e,t,n){var o=this;return e.operator?"("+o.makeExpression(e.left,t,n)+" "+e.operator+" "+o.makeExpression(e.right,t,n)+")":o.makeGetterPhrase(e.items,t,n)},getClassName:function(e){var t="";if(e.length>0){var n=0;while(n<e.length){var o=e[n].toLowerCase();t+=o.charAt(0).toUpperCase()+o.slice(1),n+=1}}return t},getReferenceName:function(e){var t=e[0].toLowerCase();if(e.length>0){var n=1;while(n<e.length){var o=e[n].toLowerCase();t+=o.charAt(0).toUpperCase()+o.slice(1),n+=1}}return t}});function P(e,t,n,o,a){var r=M.getIndent(t),i="";"class"===e.type?i+=r+e.type+" "+e.name+" {\n":"method"===e.type?(i+=r+e.name+"(",e.params&&e.params.forEach((function(e,t){t>0&&(i+=", "),i+=e.class+" "+e.name})),i+=") {\n"):"init"===e.type?"class"===a||(i+=r+e.left.class+" "+e.left.name,e.right&&(i+=" = "+M.makeExpression(e.right.expression,"this",o)),i+=";\n"):"assign"===e.type?(i+=r+M.makeGetterPhrase(e.left.items,"this",o),i+=" = "+M.makeExpression(e.right.expression,"this",o)+";\n"):"entrypoint"===e.type||("call"===e.type?i+=M.makeExpression(e,"this",o)+";\n":"if"===e.type&&(i+=r+"if "+M.makeExpression(e.expression,"this",o)+" {\n")),"entrypoint"===a&&(i=i.trim()+"\n"),n[0]+=i,e.children?(e.children.forEach((function(a){P(a,t+1,n,o,e.id)})),"entrypoint"===e.type?n[0]+="\n":n[0]+=r+"}\n"):"class"!==e.type&&"method"!==e.type&&"if"!==e.type||(n[0]+=r+"}\n")}var I={setup:function(){var e=Object(o["v"])(""),t=new Map,n={},a=[new Map,new Map],r={type:"class",id:"class",name:"Test",children:[]},i={type:"entrypoint",id:"entrypoint",children:[{type:"init",id:"execution-instance",left:{class:"const",name:"classInstance1"},right:{expression:{items:[{type:"new",value:"Test()"}]}}}]},c=new Map;c.set("execution-instance",i.children[0]),a[1].set("entrypoint",c),n.execConnections=new Map,n.valueConnections=new Map,n.nodes=[],n.next=function(t){var n=this.execConnections.get(t);if(n)n.node.execute(i);else{var o=[""];P(r,0,o,a,null);var c=[""];P(i,0,c,a,"entrypoint"),e.value=o[0].trim()+"\n"+c[0],new Function(e.value)()}},n.trace=function(e,t){var n=this.valueConnections.get(e);"var"===n.node.comp&&(t.id=n.node.id)},n.fresh=function(){i.children.splice(0,i.children.length),i.children.push({type:"init",id:"execution-instance",left:{class:"const",name:"classInstance1"},right:{expression:{items:[{type:"new",value:"Test()"}]}}})},n.scanNodes=function(){var e={type:"method",id:Object(O["a"])(),name:"constructor",return:{class:""},params:[],children:[]};n.nodes.forEach((function(t){"var"===t.comp&&(r.children.push({type:"init",id:t.id,left:{class:"String",name:"myStringVar1"}}),e.children.push({type:"assign",left:{items:[{type:"instance"},{type:"classVar",id:t.id}]},right:{expression:{items:[{type:"value",value:'""'}]}}}))})),r.children.push(e),M.parseTreeNodeIds(r,a,null),console.log(a)};var s={makingConnection:!1,startSocket:null,endSocket:null,canDrag:!0,startNode:null,endNode:null};return Object(o["o"])((function(){var e=Object(w["d"])().addTo("#drawing").size("70vw","100vh"),o=e.path("M 0 0 L 0 0");o.stroke({color:"#d61c00",width:5,linecap:"round",linejoin:"round"}),o.hide(),e.on("mouseup",(function(){if(s.makingConnection)if(s.endSocket)if(o.hide(),s.startNode===s.endNode)alert("Cannot make connection on the same node!");else if(n.execConnections.has(s.startSocket.id))alert("Output socket can only have 1 connection!");else if(n.execConnections.get(s.startSocket.id)===s.endSocket.id)alert("Cannot make duplicate connection!");else if(s.startSocket.type!==s.endSocket.type)alert("Not same type!");else{console.log("make connection!");var a=Object(O["a"])(),r=10;s.endSocket.type===C.string.name&&(r=40);var i=e.path("M "+s.startSocket.svg.cx()+" "+s.startSocket.svg.cy()+" L "+(s.endSocket.svg.cx()-r)+" "+s.endSocket.svg.cy());i.stroke({color:"#a63c01",width:5,linecap:"round",linejoin:"round"}),t.set(a,i),s.startNode.addConnection(a,s.startSocket,s.endSocket),s.endNode.addConnection(a,s.startSocket,s.endSocket),s.startNode.svg.front(),s.endNode.svg.front(),s.startSocket.type===C.exec.name?n.execConnections.set(s.startSocket.id,s.endSocket):n.valueConnections.set(s.endSocket.id,s.startSocket),s.endSocket.hideInput()}else o.hide();s.makingConnection=!1,s.startSocket=null,s.endSocket=null,s.startNode=null,s.endNode=null})),e.on("mousemove",(function(e){if(s.makingConnection){var t=s.startSocket.svg.cx(),n=s.startSocket.svg.cy(),a=e.offsetX,r=e.offsetY;o.plot("M "+t+" "+n+" L "+a+" "+r),o.show()}}));var a=new N(e,n,s,t,"Button v2","button");a.addSocket(C.exec.name,"out"),a.addSocket(C.int.name,"out");var r=new N(e,n,s,t,"myStringVar1","var");r.addSocket(C.exec.name,"in"),r.addSocket(C.exec.name,"out"),r.addSocket(C.string.name,"out"),r.addSocket(C.string.name,"in");var i=new N(e,n,s,t,"Alert()","alert()");i.addSocket(C.exec.name,"in"),i.addSocket(C.exec.name,"out"),i.addSocket(C.string.name,"in"),n.nodes.push(a),n.nodes.push(r),n.nodes.push(i),n.scanNodes()})),{codes:e}}};n("97e7");const L=l()(I,[["render",j],["__scopeId","data-v-504bdd84"]]);var T=L,V={components:{MySVG:T}};const _=l()(V,[["render",h]]);var A=_,G=[{path:"/",name:"Home",component:A},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],B=Object(v["a"])({history:Object(v["b"])(),routes:G}),D=B,q=n("5502"),J=Object(q["a"])({state:{},mutations:{},actions:{},modules:{}}),H=(n("6470"),n("1020")),U=n.n(H),z=n("4dd1"),F=n.n(z),R=n("b056");U.a.registerLanguage("javascript",F.a),Object(o["c"])(f).use(J).use(D).use(R["a"]).mount("#app")},"97e7":function(e,t,n){"use strict";n("4ea1")},d446:function(e,t,n){}});
//# sourceMappingURL=app.141eafc8.js.map